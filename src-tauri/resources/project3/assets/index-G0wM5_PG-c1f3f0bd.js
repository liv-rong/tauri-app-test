import{m as a,v as I,t as f,X as h}from"./BaseSelectComp-10db33f3.js";import{r as y}from"./index-626914f7.js";import"./index.esm-0b9baea5.js";import"./canvas-0ce26167.js";import"./index-383ddd63.js";var P=Object.defineProperty,g=Object.defineProperties,_=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,b=(r,e,t)=>e in r?P(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,C=(r,e)=>{for(var t in e||(e={}))k.call(e,t)&&b(r,t,e[t]);if(j)for(var t of j(e))B.call(e,t)&&b(r,t,e[t]);return r},O=(r,e)=>g(r,_(e)),N=(r,e,t)=>new Promise((v,m)=>{var w=i=>{try{l(t.next(i))}catch(s){m(s)}},o=i=>{try{l(t.throw(i))}catch(s){m(s)}},l=i=>i.done?v(i.value):Promise.resolve(i.value).then(w,o);l((t=t.apply(r,e)).next())});const S="ppt_allPreview-module__previewContainer--ooBd8",H="ppt_allPreview-module__content--K--iB",W="ppt_allPreview-module__close--5ZkzB",Z="ppt_allPreview-module__preview---obOi",M="ppt_allPreview-module__previewButton--jc6so",L="ppt_allPreview-module__previewIndex--tXaJY",d={previewContainer:S,content:H,close:W,preview:Z,previewButton:M,previewIndex:L},F=({data:r,onSelect:e,activeId:t,setMode:v})=>{const[m,w]=y.useState([]);return y.useEffect(()=>{let o=!1;const l=i=>new Promise(s=>{const p=new f.fabric.StaticCanvas(document.createElement("canvas"),{width:h.width,height:h.height}),u=JSON.parse(JSON.stringify(i)),x=c=>c.map(n=>(n==null?void 0:n.type)==="image"&&n!=null&&n.src?O(C({},n),{crossOrigin:"anonymous"}):n);u.objects&&(u.objects=x(u.objects)),p.loadFromJSON(u,()=>{p.renderAll();let c="";try{c=p.toDataURL({format:"png",quality:.7})}catch{try{c=p.toDataURL({format:"png",quality:.7})}catch{c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjkwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNlZWUiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjExIiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7kuYvliY3kv6Hku7bkuo4uLi48L3RleHQ+PC9zdmc+"}}s({id:i.id||String(Math.random()),url:c}),p.dispose()})});return N(void 0,null,function*(){const i=yield Promise.all(r.map(s=>l(s)));o||w(i)}),()=>{o=!0}},[r]),a.jsxs("div",{className:`${d.previewContainer}`,children:[a.jsx("div",{onClick:()=>v(""),"aria-hidden":!0,style:{position:"absolute",inset:0}}),a.jsxs("div",{className:d.content,children:[a.jsx("div",{className:d.close,onClick:()=>v(""),children:a.jsx(I,{style:{fontSize:"1.5rem",lineHeight:"2rem",color:"white"}})}),a.jsx("div",{style:{width:"100%"},children:a.jsx("div",{style:{width:"100%",justifyContent:"center",display:"flex"},children:a.jsx("div",{className:d.preview,children:m.map((o,l)=>a.jsxs("button",{onClick:()=>{e==null||e(o.id)},className:d.previewButton,style:{height:"auto",backgroundColor:"white",boxShadow:t===o.id?"0 8px 25px rgba(0, 0, 0, 0.3)":"none",border:t===o.id?"2px solid var(--primary)":"0px solid transparent"},children:[a.jsx("img",{src:o.url,alt:`第${l+1}页`,style:{width:"100%",height:"100%",objectFit:"cover"}}),a.jsx("div",{className:d.previewIndex,children:l+1})]},o.id||l))})})})]})]})};export{F as default};
